
<script type="text/javascript" src="http://platform.linkedin.com/in.js?async=true"></script>
<script type="text/javascript">
    IN.init({
        onLoad: 'requestFields',
        api_key: '8z6zdjt5yetc',
        scope: 'r_basicprofile r_emailaddress r_contactinfo r_fullprofile',
        authorize: true
    });
    
    function login(result) {
        var id = result.values[0].id;
        var field = document.getElementById('login-text-field-login-id');
        var form = document.getElementById('login-form');
        
        console.log(form, field);
        
        if (form && field) {
            field.value = id;
            // form.submit();
        }
    }
    
    function requestFields() {
        IN.User.authorize(onAuthorized);
    }
    
    function onAuthorized() {
        IN.API.Profile("me").fields("id").result(login);
    }
</script>

<!--
<script type="text/javascript">
document.body.onload = function() {
  document.getElementById('users_new_text_field_login_id').value = 'ufR4XdCyCC';
}
</script>
-->

<%= form_tag '/admin/login', :id => 'login-form' do %>
  <%= text_field_tag :login_id, nil, :id => 'login-text-field-login-id' %>
  <br />
  <%= submit_tag 'Login', :id => 'login-submit' %>
<% end %>
